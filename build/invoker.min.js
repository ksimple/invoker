var invoke=function(){function a(){var a,b,c=!1,d=!1;this.done=function(e){if(d)throw new Error("Done can't be call twice");d=!0,c?e(a):b=e},this.setResult=function(e){if(c)throw new Error("setResult can't be call twice");d?(b&&b(e),c=!0):(a=e,c=!0)}}function b(d){function e(a){var b=/^\s*function.*?\((.*?)\)/.exec(a.toString());if(b){var c=b[1].replace(/\s*/g,"");return c.length>0?c.replace(/\s*/g,"").split(","):[]}return[]}function f(a,b,c,d){function e(e,f){i[e]=f,h++,h>=a.length&&(j?c.apply(b,i):d.setResult(c.apply(b,i)))}function f(a,b){return function(c){return a(b,c)}}if(0===a.length)d.setResult(c.apply(b,[]));else for(var h=0,i=[],j=!1,k=0;k<a.length;k++){var l=a[k];g(l).done(f(e,k))}}function g(b){var c=h[b],e=new a;if("$invoke"==b)e.setResult(k);else if("undefined"==typeof c)d?d([b,function(a){return e.setResult(a)}]):e.setResult(void 0);else if("raw"===c.type)e.setResult(c.rawValue);else{if("factory"!==c.type)throw new Error("Not recongnized injection type");j||(j=k.inherit()),j.inject("$done",function(a){return e.setResult(a)}),c.isAsync?j(c.factory):j(c.factory).done(function(a){return e.setResult(a)})}return e}"undefined"==typeof d&&(d=null);var h={},i={},j=null,k=function(){for(var b=[],c=0;c<arguments.length-0;c++)b[c]=arguments[c+0];if(0!=b.length){b=Array.prototype.slice.apply(arguments);var d=b.pop();"function"==typeof d&&0===b.length?b=e(d):"object"==typeof d&&d instanceof Array&&(b=d,d=b.pop());var g=new a;return f(b,null,d,g),g}};return k.resolve=function(a){return g(a)},k.get=function(a){var b,c=!1;if(g(a).done(function(a){b=a,c=!0}),!c)throw new Error("Can't get result of async injected");return b},k.withThis=function(){for(var b=[],c=0;c<arguments.length-0;c++)b[c]=arguments[c+0];if(0!=b.length){var d,g;if(1==b.length){if(!(b[0]instanceof Array))return;if(b=b[0],b.length<2)return;g=b.pop(),d=b.pop()}else{if(b=Array.prototype.slice.apply(arguments),b.length<2)return;g=b.pop(),d=b.pop(),0==b.length&&(b=e(g))}var h=new a;return f(b,d,g,h),h}},k.injectFactory=function(a,b){var c,d;"function"==typeof b?(c=e(b),c.push(b)):"object"==typeof b&&b instanceof Array&&(c=b),d=c.indexOf("$done")>0,h[a]={type:"factory",isAsync:c.indexOf("$done")>=0,factory:c}},k.inject=function(a,b){h[a]={type:"raw",rawValue:b}},k.clearInject=function(a){delete h[a]},k.config=function(a){for(var b in a)i[b]=a[b]},k.inherit=function(){var a=b(this);return a},k.clone=function(){var a=b(d);for(var c in h)"raw"===h[c].type?a.inject(h[c],h[c].rawValue):"factory"===h[c].type&&a.injectFactory(h[c],h[c].factory);return a.config(i),a},k.create=function(){var a=b();return a},k.id=c++,k}var c=0;return b()}();